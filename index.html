<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super Liga Chilena Pro</title>
    <style>
        body { margin: 0; overflow: hidden; background: #008ecc; font-family: 'Arial Black', sans-serif; touch-action: none; }
        
        /* Interfaz de Usuario */
        #ui-layer {
            position: absolute; width: 100%; top: 0; left: 0;
            display: flex; flex-direction: column; align-items: center; z-index: 10;
        }
        .header-title { 
            background: #ffffff; width: 100%; text-align: center; 
            padding: 10px 0; color: #008ecc; font-size: 24px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .sub-title { color: white; background: #005a82; width: 100%; text-align: center; padding: 5px 0; font-size: 18px; }
        
        /* Menú de Selección */
        #selector {
            position: absolute; inset: 0; background: rgba(0, 71, 102, 0.95);
            display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100;
        }
        .equipos { display: flex; gap: 15px; margin-top: 20px; }
        .btn-escudo { 
            background: white; border: 5px solid #f1c40f; border-radius: 15px;
            width: 80px; height: 80px; cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .btn-escudo img { width: 85%; height: 85%; object-fit: contain; }
        
        canvas { display: block; background: linear-gradient(#008ecc, #61c4ed); }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="ui-layer">
    <div class="header-title">Super Liga Chilena Pro</div>
    <div class="sub-title" id="subStatus">ELIGE TU EQUIPO</div>
</div>

<div id="selector">
    <div class="equipos">
        <div class="btn-escudo" onclick="iniciar(0)"><img src="colo.png"></div>
        <div class="btn-escudo" onclick="iniciar(1)"><img src="uchile.png"></div>
        <div class="btn-escudo" onclick="iniciar(2)"><img src="uc.png"></div>
    </div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const subStatus = document.getElementById("subStatus");
const selector = document.getElementById("selector");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const archivos = ["colo.png", "uchile.png", "uc.png"];
let imgJugador = new Image();
let imagenesRivales = [];
let activo = false;
let goles = 0;
let obstaculos = [];

const p = { x: 70, y: 0, w: 70, h: 70, dy: 0, salto: 17, grav: 0.9, suelo: false };

function iniciar(idx) {
    imgJugador.src = archivos[idx];
    imagenesRivales = archivos.filter((_, i) => i !== idx).map(src => {
        let img = new Image();
        img.src = src;
        return img;
    });

    selector.classList.add("hidden");
    subStatus.innerText = "¡GOLES: 0!";
    activo = true;
    goles = 0;
    obstaculos = [];
    p.y = canvas.height - 180;
    loop();
}

function saltar() {
    if (p.suelo && activo) {
        p.dy = -p.salto;
        p.suelo = false;
    }
}

function spawn() {
    if (activo) {
        let imgR = imagenesRivales[Math.floor(Math.random() * imagenesRivales.length)];
        obstaculos.push({ x: canvas.width, w: 65, h: 65, img: imgR });
    }
}

function loop() {
    if (!activo) return;

    p.dy += p.grav;
    p.y += p.dy;
    const groundY = canvas.height - 60;

    if (p.y + p.h > groundY) {
        p.y = groundY - p.h;
        p.dy = 0;
        p.suelo = true;
    }

    obstaculos.forEach((o, i) => {
        o.x -= 8;
        // Colisión basada en tu imagen (escudo contra escudo)
        if (p.x < o.x + o.w - 15 && p.x + p.w - 15 > o.x && p.y + p.h > groundY - o.h) {
            activo = false;
            subStatus.innerText = "¡TARJETA ROJA! FINAL: " + goles;
            setTimeout(() => { location.reload(); }, 1500);
        }
        if (o.x + o.w < 0) { 
            obstaculos.splice(i, 1); 
            goles++; 
            subStatus.innerText = "¡GOLES: " + goles + "!";
        }
    });

    // Dibujo
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Pasto con línea blanca (como en tu foto)
    ctx.fillStyle = "#4caf50";
    ctx.fillRect(0, canvas.height - 60, canvas.width, 60);
    ctx.fillStyle = "white";
    ctx.fillRect(0, canvas.height - 65, canvas.width, 5); 

    // Jugador (con el tamaño de tu imagen)
    ctx.drawImage(imgJugador, p.x, p.y, p.w, p.h);
    
    // Rivales
    obstaculos.forEach(o => {
        ctx.drawImage(o.img, o.x, groundY
