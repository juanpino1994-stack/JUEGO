<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super Liga Pro - Final</title>
    <style>
        body { margin: 0; overflow: hidden; background: #008ecc; font-family: 'Arial Black', sans-serif; touch-action: none; }
        #selector { position: absolute; inset: 0; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; color: white; text-align: center; }
        .equipos { display: flex; gap: 10px; margin-top: 20px; }
        .btn { background: white; border: 4px solid #f1c40f; border-radius: 12px; width: 80px; height: 80px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .btn img { width: 85%; height: 85%; object-fit: contain; }
        canvas { display: block; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="selector">
    <h2>ELIGE TU EQUIPO</h2>
    <div class="equipos">
        <div class="btn" onclick="iniciar(0)"><img src="u.png" onerror="this.parentElement.style.display='none'; console.log('No se halló u.png')"></div>
        <div class="btn" onclick="iniciar(1)"><img src="colo.png" onerror="this.parentElement.style.display='none'; console.log('No se halló colo.png')"></div>
        <div class="btn" onclick="iniciar(2)"><img src="uc.png" onerror="this.parentElement.style.display='none'; console.log('No se halló uc.png')"></div>
    </div>
    <p style="margin-top:20px; font-size: 14px;">Si no ves los 3, revisa los nombres en GitHub</p>
</div>

<canvas id="juego"></canvas>

<script>
const canvas = document.getElementById("juego");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const fotos = ["u.png", "colo.png", "uc.png"];
let imgJugador = new Image();
let imgRivales = [];
let activo = false;
let goles = 0;
let obstaculos = [];

let p = { x: 50, y: 0, w: 65, h: 65, dy: 0, salto: 16, grav: 0.8, suelo: false };

function iniciar(idx) {
    imgJugador.src = fotos[idx];
    // Rivales son los otros dos
    imgRivales = fotos.filter((_, i) => i !== idx).map(src => {
        let img = new Image();
        img.src = src;
        return img;
    });

    document.getElementById("selector").classList.add("hidden");
    activo = true;
    p.y = canvas.height - 150;
    loop();
}

function spawn() {
    if(activo) {
        let r = imgRivales[Math.floor(Math.random() * imgRivales.length)];
        obstaculos.push({ x: canvas.width, w: 60, h: 60, img: r });
    }
}

function loop() {
    if(!activo) return;

    // Física
    p.dy += p.grav;
    p.y += p.dy;
    const sueloY = canvas.height - 50;

    if(p.y + p.h > sueloY) {
        p.y = sueloY - p.h;
        p.dy = 0;
        p.suelo = true;
    }

    // Obstáculos
    for(let i = obstaculos.length - 1; i >= 0; i--) {
        let o = obstaculos[i];
        o.x -= 8;

        // Colisión (Tarjeta Roja)
        if(p.x < o.x + o.w - 15 && p.x + p.w - 15 > o.x && p.y + p.h > sueloY - o.h) {
            activo = false;
            alert("¡TARJETA ROJA! Goles: " + goles);
            location.reload();
        }

        // Punto (Gol)
        if(o.x + o.w < 0) {
            obstaculos.splice(i, 1);
            goles++;
        }
    }

    // Dibujar
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Pasto
    ctx.fillStyle = "#4caf50";
    ctx.fillRect(0, sueloY, canvas.width, 50);
    ctx.fillStyle = "white";
    ctx.fillRect(0, sueloY - 5, canvas.width, 5);

    // Personajes
    ctx.drawImage(imgJugador, p.x, p.y, p.w, p.h);
    obstaculos.forEach(o => {
        ctx.drawImage(o.img, o.x, sueloY - o.h, o.w, o.h);
    });

    // Marcador
    ctx.fillStyle = "white";
    ctx.font = "bold 24px Arial";
    ctx.fillText("GOLES: " + goles, 20, 50);

    requestAnimationFrame(loop);
}

// Controles touch
window.addEventListener("touchstart", (e) => {
    e.preventDefault();
    if(p.suelo && activo) {
        p.dy = -p.salto;
        p.suelo = false;
    }
}, {passive: false});

setInterval(spawn, 1400);
</script>
</body>
</html>
